<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞ (–õ—ñ—á–∏–ª—å–Ω–∏–∫ –ï–Ω–µ—Ä–≥—ñ—ó) ‚ö°</title>
    
    <meta property="og:title" content="‚ö° –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó ‚ö°">
    <meta property="og:description" content="–®–≤–∏–¥–∫–∏–π –æ–Ω–ª–∞–π–Ω-—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó –∑–∞ —á–∞—Å–æ–º –∞–±–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —ñ–º–ø—É–ª—å—Å—ñ–≤.">
    <meta property="og:url" content="https://mikeicy.github.io/calculator">
    <meta property="og:type" content="website">
    <style>
        /* !!! –ö–õ–Æ–ß–û–í–ï –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø: –ì–õ–û–ë–ê–õ–¨–ù–ò–ô BOX-SIZING !!! */
        *, *::before, *::after {
            box-sizing: border-box;
        }
        /* ======================================================= */
        /* === –û–°–ù–û–í–ù–Ü –û–ü–¢–ò–ú–Ü–ó–ê–¶–Ü–á –î–õ–Ø –ú–û–ë–Ü–õ–¨–ù–û–á –í–ï–†–°–Ü–á (Mobile-First) === */
        /* ======================================================= */

        body {
            font-family: Arial, sans-serif;
            margin: 10px; 
            background-color: #f4f7f6;
            color: #333;
        }
        .container {
            max-width: 650px;
            margin: 0 auto;
            background-color: #fff;
            padding: 15px; 
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        /* --- –û–ù–û–í–õ–ï–ù–ò–ô –°–¢–ò–õ–¨ –î–õ–Ø –ó–ê–ì–û–õ–û–í–ö–ê --- */
        h1 {
            color: #007bff;
            text-align: center;
            font-size: 1.6em; 
            margin-bottom: 0px; 
        }
        
        .h1-subtitle {
             color: #555;
             text-align: center;
             font-size: 0.9em; 
             margin-bottom: 15px;
             margin-top: 5px; 
             font-weight: normal;
             display: block;
        }
        
        /* === –ó–ú–Ü–ù–ê: –Ñ–î–ò–ù–ò–ô –°–¢–ò–õ–¨ –î–õ–Ø –ó–ê–ì–û–õ–û–í–ö–Ü–í –ë–õ–û–ö–Ü–í (h2, h3) === */
        h2, h3 {
            color: #333; /* –¢–µ–º–Ω–∏–π –∫–æ–ª—ñ—Ä –¥–ª—è –∫—Ä–∞—â–æ—ó —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ */
            font-size: 1.25em; 
            font-weight: bold;
            border-bottom: 2px solid #007bff; /* –í–∏–¥—ñ–ª–µ–Ω–Ω—è –ª—ñ–Ω—ñ—î—é */
            padding-bottom: 5px;
            margin-top: 20px;
            margin-bottom: 15px;
        }

        /* –ö–ª—é—á–æ–≤–∏–π —Å—Ç–∏–ª—å –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –∑—É–º—É –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö */
        input[type="number"] {
            font-size: 16px; 
        }

        /* --- –°–¢–ò–õ–Ü –î–õ–Ø U, I, P (–ö–û–ñ–ï–ù –ë–õ–û–ö 100% –®–ò–†–ò–ù–ò) --- */

        /* –ó–∞–±–µ–∑–ø–µ—á—É—î–º–æ –≤—ñ–¥—Å—Ç—É–ø–∏ –º—ñ–∂ —É—Å—ñ–º–∞ –≤–≤—ñ–¥–Ω–∏–º–∏ –≥—Ä—É–ø–∞–º–∏ U, I, P */
        #voltageRow, #currentRow, #powerRow {
            margin-bottom: 10px; 
        }
        
        .styled-input-group {
            display: flex;
            flex-direction: column;
            border: 1px solid #dcdcdc; 
            border-radius: 15px;
            padding: 10px; 
            transition: border-color 0.3s, box-shadow 0.3s;
            background-color: #fff;
        }
        
        /* === –î–û–î–ê–ù–û: –°–¢–ò–õ–¨ –î–õ–Ø –ü–Ü–î–°–í–Ü–ß–£–í–ê–ù–ù–Ø –ü–û–ú–ò–õ–û–ö === */
        .error-highlight {
            border-color: #dc3545 !important; 
            box-shadow: 0 0 10px rgba(220, 53, 69, 0.5) !important;
            background-color: #fcebeb !important; /* –ù–∞–ø—ñ–≤–ø—Ä–æ–∑–æ—Ä–∏–π —á–µ—Ä–≤–æ–Ω–∏–π —Ñ–æ–Ω */
        }

        .styled-input-group.filled {
            border-color: #28a745; 
            box-shadow: 0 0 10px rgba(40, 167, 69, 0.5);
            background-color: #e9f5e9; 
        }

        .styled-input-group label {
            text-align: center;
            font-weight: bold;
            font-size: 1em; 
            color: #333;
            margin-bottom: 5px; 
            order: 1;
        }

        .styled-input-group input {
            width: 100%;
            padding: 8px; 
            margin: 0;
            border: 1px solid #ccc; 
            border-radius: 8px;
            text-align: center;
            font-size: 1.2em; 
            font-weight: bold;
            order: 2;
            background-color: transparent; 
        }
        
        /* –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø: –í–ò–î–ê–õ–ï–ù–ù–Ø –°–¢–ê–ù–î–ê–†–¢–ù–û–ì–û OUTLINE –ù–ê –§–û–ö–£–°–Ü */
        .styled-input-group input:focus {
            outline: none; 
            border-color: #007bff; 
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5); 
        }
        
        .styled-input-group.filled input {
            border: 1px solid #28a745; 
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è "–ê–±–æ" */
        .or-separator {
            text-align: center;
            font-weight: bold;
            margin: 10px 0; 
            font-size: 1.1em; 
            color: #007bff;
        }

        /* –ù–û–í–ò–ô –°–¢–ò–õ–¨: –°—Ç–∏–ª—å –¥–ª—è –∑–Ω–∞–∫—É –º–Ω–æ–∂–µ–Ω–Ω—è/—Ä—ñ–≤–Ω–æ—Å—Ç—ñ */
        .symbol-separator {
            text-align: center;
            font-weight: bold;
            margin: 0px 0; 
            font-size: 2.0em; 
            color: #007bff;
        }
        
        /* ============================================== */
        /* !!! –í–ò–î–ê–õ–ï–ù–û –í–°–Ü –°–¢–ò–õ–Ü #meterConstantGroup –î–õ–Ø –£–ù–Ü–§–Ü–ö–ê–¶–Ü–á !!! */
        /* ============================================== */

        /* --- –°—Ç–∏–ª—ñ –¥–ª—è –∫–Ω–æ–ø–æ–∫-–ø–µ—Ä–µ–º–∏–∫–∞—á—ñ–≤ --- */

        .mode-button-group {
            display: flex;
            flex-direction: column; 
            gap: 10px;
            margin-bottom: 15px; 
        }
        .mode-button-group input[type="radio"] {
            display: none;
        }
        .mode-button-group label {
            flex-grow: 1;
            text-align: center;
            padding: 10px 15px; 
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s, color 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border: 2px solid;
        }
        
        #modePulses + label { background-color: #fff7f0; color: #ff6a00; border-color: #ff6a00; }
        #modePulses:checked + label { background-color: #ff6a00; color: white; }
        #modeTime + label { background-color: #f0f7ff; color: #007bff; border-color: #007bff; }
        #modeTime:checked + label { background-color: #007bff; color: white; }
        
        .input-group {
            margin-bottom: 15px;
        }
        .hidden-input {
            display: none;
            margin-top: 10px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px dashed #ccc;
        }
        
        /* –°—Ç–∏–ª—å –¥–ª—è INPUT –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ hidden-input (–ö—ñ–ª—å–∫—ñ—Å—Ç—å —ñ–º–ø—É–ª—å—Å—ñ–≤) */
        #inputPulses input {
            width: 100%;
            padding: 8px; 
            margin: 5px 0 0; 
            border: 1px solid #ccc; 
            border-radius: 8px;
            text-align: center;
            font-size: 1.2em; 
            font-weight: bold;
            background-color: white; 
        }
        
        /* –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø: –í–ò–î–ê–õ–ï–ù–ù–Ø –°–¢–ê–ù–î–ê–†–¢–ù–û–ì–û OUTLINE –ù–ê –§–û–ö–£–°–Ü */
        #inputPulses input:focus {
             outline: none;
             border-color: #007bff;
             box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
        }
        
        /* === –î–û–î–ê–ù–û: –°–¢–ò–õ–¨ –î–õ–Ø –ü–Ü–î–°–í–Ü–ß–£–í–ê–ù–ù–Ø –ü–û–ú–ò–õ–û–ö INPUT –í inputPulses === */
        #inputPulses.error-highlight input {
             border-color: #dc3545 !important;
             box-shadow: 0 0 5px rgba(220, 53, 69, 0.5) !important;
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –°–µ–∫—É–Ω–¥–æ–º—ñ—Ä–∞ */
        #timerSection {
            text-align: center;
            padding: 15px;
            margin-top: 10px; 
            border: 2px solid #28a745;
            border-radius: 8px;
            background-color: #f0fff0;
            transition: background-color 0.1s; /* –î–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –±–ª–∏–º–∞–Ω–Ω—è */
        }
        
        /* –ù–û–í–ò–ô –°–¢–ò–õ–¨: –§–æ–Ω, —â–æ —ñ–º—ñ—Ç—É—î —ñ–º–ø—É–ª—å—Å (–±–ª–∏–º–∞–Ω–Ω—è) */
        /* –ó–ú–Ü–ù–ê: –ó–º—ñ–Ω–µ–Ω–æ –∫–æ–ª—ñ—Ä –∑ —Å–∏–Ω—å–æ–≥–æ –Ω–∞ —á–µ—Ä–≤–æ–Ω–∏–π */
        #timerSection.flash-active {
            background-color: #ff0000; /* –Ø—Å–∫—Ä–∞–≤–∏–π –ß–ï–†–í–û–ù–ò–ô –∫–æ–ª—ñ—Ä —ñ–º–ø—É–ª—å—Å—É */
        }
        
        #timerDisplay {
            font-size: 2em; 
            font-weight: bold;
            margin-bottom: 10px; 
            color: #28a745;
        }
        
        #timerSection.flash-active #timerDisplay {
             color: white; /* –ó–º—ñ–Ω–∞ –∫–æ–ª—å–æ—Ä—É —Ç–µ–∫—Å—Ç—É –ø—ñ–¥ —á–∞—Å –±–ª–∏–º–∞–Ω–Ω—è */
        }
        
        /* === –ù–û–í–Ü –°–¢–ò–õ–Ü –î–õ–Ø –ö–ù–û–ü–û–ö –°–ï–ö–£–ù–î–û–ú–Ü–†–ê === */
        .timer-buttons {
            display: flex;
            flex-direction: column; /* Stack vertically: Start/Stop then Reset */
            align-items: center; /* Center items horizontally */
            gap: 15px; 
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –≤–µ–ª–∏–∫–æ—ó –∫—Ä—É–≥–ª–æ—ó –∫–Ω–æ–ø–∫–∏ –°–¢–ê–†–¢/–°–¢–û–ü */
        #startStopBtn {
            background-color: #17a2b8;
            width: 150px; /* –í–µ–ª–∏–∫–∏–π —Ä–æ–∑–º—ñ—Ä */
            height: 150px; /* –í–µ–ª–∏–∫–∏–π —Ä–æ–∑–º—ñ—Ä –¥–ª—è –∫–æ–ª–∞ */
            border-radius: 50%; /* –ö—Ä—É–≥–ª–∞ —Ñ–æ—Ä–º–∞ */
            padding: 0; 
            border: none;
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 1.5em; /* –ë—ñ–ª—å—à–∏–π —à—Ä–∏—Ñ—Ç */
            box-shadow: 0 8px 15px rgba(0,0,0,0.2); 
            flex-grow: 0;
            transition: background-color 0.2s, transform 0.1s;
        }
        
        #startStopBtn:active {
            transform: scale(0.98); /* –ï—Ñ–µ–∫—Ç –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è */
        }
        
        /* –°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ –°–ö–ò–î–ê–ù–ù–Ø */
        #resetBtn {
            background-color: #6c757d;
            width: 80%; /* –¢—Ä–æ—Ö–∏ –º–µ–Ω—à–∞ —à–∏—Ä–∏–Ω–∞ */
            max-width: 250px;
            padding: 10px; 
            border: none;
            border-radius: 8px; 
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 1em; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
            flex-grow: 0;
        }
        /* ======================================= */

        /* –°—Ç–∏–ª—ñ –¥–ª—è –ë–õ–û–ö–£ –†–ï–ó–£–õ–¨–¢–ê–¢–Ü–í */
        #result {
            margin-top: 15px; 
            padding: 15px; 
            background-color: #e6f7ff; 
            border: 2px solid #007bff;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.1);
            color: #1a1a1a;
            text-align: center; /* –¶–µ–Ω—Ç—Ä—É—î–º–æ –≤–º—ñ—Å—Ç */
        }

        /* –û–ù–û–í–õ–ï–ù–û: –°—Ç–∏–ª—å –¥–ª—è –≤–µ–ª–∏–∫–æ–≥–æ –±–ª–æ–∫—É –∑ —á–∏—Å–ª–∞–º–∏ */
        .large-result-display {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 10px 0;
            gap: 15px; /* –í—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ –±–ª–æ–∫–∞–º–∏ */
        }

        /* –û–ù–û–í–õ–ï–ù–û: –°—Ç–∏–ª—å –¥–ª—è –æ–∫—Ä–µ–º–æ–≥–æ –±–ª–æ–∫—É —á–∏—Å–ª–∞ —Ç–∞ –ø—ñ–¥–ø–∏—Å—É */
        .result-block {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* –û–ù–û–í–õ–ï–ù–û: –°—Ç–∏–ª—å –¥–ª—è —Å–∞–º–æ–≥–æ –≤–µ–ª–∏–∫–æ–≥–æ —á–∏—Å–ª–∞ */
        .result-value {
            font-size: 3.5em; /* –î—É–∂–µ –≤–µ–ª–∏–∫–∏–π —à—Ä–∏—Ñ—Ç */
            font-weight: 900; /* –ï–∫—Å—Ç—Ä–∞ –∂–∏—Ä–Ω–∏–π */
            color: #007bff; /* –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–ª—ñ—Ä */
            padding: 5px 15px;
            border-radius: 8px;
            background-color: #f0f8ff; /* –õ–µ–≥–∫–∏–π —Ñ–æ–Ω –¥–ª—è –≤–∏–¥—ñ–ª–µ–Ω–Ω—è */
        }

        /* –û–ù–û–í–õ–ï–ù–û: –°—Ç–∏–ª—å –¥–ª—è —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫–∞ (—Å—Ö–æ–∂–æ–≥–æ –Ω–∞ /) */
        .result-separator {
            font-size: 3.5em;
            font-weight: 200;
            color: #999;
        }

        /* –û–ù–û–í–õ–ï–ù–û: –°—Ç–∏–ª—å –¥–ª—è –ø—ñ–¥–ø–∏—Å—É –ø—ñ–¥ —á–∏—Å–ª–æ–º */
        .result-label {
            font-size: 1.1em;
            font-weight: bold;
            color: #555;
            margin-top: 5px;
        }

        #result p {
            font-size: 1.1em; /* –ó–±—ñ–ª—å—à—É—î–º–æ —à—Ä–∏—Ñ—Ç –¥–ª—è –∑–∞–≥–∞–ª—å–Ω–∏—Ö –ø–∞—Ä–∞–≥—Ä–∞—Ñ—ñ–≤ */
            margin: 8px 0;
        }
        
        #result strong {
            font-weight: bold; 
            color: #007bff; 
        }
        
        /* === –°–¢–ò–õ–Ü –î–õ–Ø –î–û–í–Ü–î–ö–ò === */
        /* –ù–û–í–ò–ô –°–¢–ò–õ–¨: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –î–æ–≤—ñ–¥–∫–∏ –∑ –∫—É—Ä—Å–æ—Ä–æ–º */
        #referenceHeader {
            cursor: pointer;
            transition: color 0.2s;
            /* –í–ò–î–ê–õ–ï–ù–û: margin-top: 15px; */
            /* –í–ò–î–ê–õ–ï–ù–û: margin-bottom: 0; */
        }
        
        #referenceHeader:hover {
            color: #ff6a00; /* –ó–º—ñ–Ω—é—î–º–æ –∫–æ–ª—ñ—Ä –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ */
        }

        #referenceContent {
            /* –î–æ–¥–∞–Ω–æ, —â–æ–± –≤–º—ñ—Å—Ç –±—É–≤ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º */
            display: none; 
            /* –î–æ–¥–∞–Ω–æ –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥—É, —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ JS-–∞–Ω—ñ–º–∞—Ü—ñ—é (–∞–ª–µ —Ç—É—Ç –∫–ª–∞—Å–∏—á–Ω–∏–π display:none) */
            /* transition: max-height 0.3s ease-out; */
            overflow: hidden; 
            
            padding: 15px; 
            background-color: #f8f9fa; 
            border: 1px solid #ced4da;
            border-radius: 8px;
            font-size: 0.9em; 
            color: #495057;
            margin-top: 10px;
        }

        #referenceContent h4 {
            color: #333;
            margin-top: 5px;
            margin-bottom: 8px;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 5px;
        }

        /* –û–ù–û–í–õ–ï–ù–ò–ô –°–¢–ò–õ–¨ –§–û–†–ú–£–õ–ò: –ß–û–†–ù–ò–ô –ö–û–õ–Ü–† –¢–ê –ñ–ò–†–ù–ò–ô –®–†–ò–§–¢ */
        #referenceContent .formula {
            font-family: 'Courier New', monospace;
            font-size: 1em; 
            color: #000000; /* –ó–º—ñ–Ω–µ–Ω–æ –Ω–∞ —á–æ—Ä–Ω–∏–π */
            font-weight: bold; /* –ó—Ä–æ–±–ª–µ–Ω–æ –∂–∏—Ä–Ω–∏–º */
            display: block;
            margin: 10px 0;
            padding: 3px; 
            background-color: #e9ecef;
            border-radius: 4px;
            overflow-x: auto; 
        }
        
        #referenceContent .value-list {
            margin-top: 10px;
            padding-left: 20px;
            list-style: disc;
        }
        
        #referenceContent .value-list strong {
            color: #28a745; 
            font-weight: bold;
        }
        
        /* === –°–¢–ò–õ–¨ –î–õ–Ø –ü–Ü–î–í–ê–õ–£ –ó –ü–û–°–ò–õ–ê–ù–ù–Ø–ú === */
        .footer-link {
            text-align: center;
            margin-top: 20px;
            padding-bottom: 10px;
            font-size: 0.9em;
            display: flex;
            flex-direction: column;
            gap: 5px; 
        }

        .footer-link a {
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s;
        }
        
        /* –°–¢–ò–õ–¨ –î–õ–Ø –ö–ù–û–ü–ö–ò –ü–Ü–î–¢–†–ò–ú–ö–ò */
        .footer-link .support-button {
             background-color: #13872c; 
             color: white;
             padding: 8px 15px;
             border-radius: 20px;
             display: inline-block;
             margin-left: 10px;
             font-size: 0.95em;
             font-weight: bold;
             text-transform: uppercase;
             box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
             transition: background-color 0.2s, transform 0.2s;
        }

        .footer-link .support-button:hover {
            background-color: #106f23;
            text-decoration: none;
            transform: translateY(-1px);
        }
        
        .footer-link a:hover {
            color: #0056b3;
            text-decoration: underline;
        }

        /* === MEDIA QUERY (–¥–ª—è –ø–ª–∞–Ω—à–µ—Ç—ñ–≤/–¥–µ—Å–∫—Ç–æ–ø—ñ–≤) === */
        @media (min-width: 500px) {
            .mode-button-group {
                flex-direction: row; 
            }
            .container {
                padding: 25px; 
            }
             .footer-link {
                flex-direction: row; /* –ù–∞ –¥–µ—Å–∫—Ç–æ–ø–∞—Ö –ø–æ—Å–∏–ª–∞–Ω–Ω—è –≤ –æ–¥–∏–Ω —Ä—è–¥–æ–∫ */
                justify-content: center;
                align-items: center;
                gap: 15px;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>‚ö° –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞ ‚ö°</h1>
    <span class="h1-subtitle">(–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó)</span> 
    <hr>
    
    <h2>1. –¢–µ—Ö–Ω—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏</h2>
    
    <div class="input-group">
        <div id="meterConstantGroup" class="styled-input-group">
            <label for="meterConstant">–ü–æ—Å—Ç—ñ–π–Ω–∞ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ (C), —ñ–º–ø/–∫–í—Ç¬∑–≥–æ–¥:</label>
            <input type="number" id="meterConstant" value="" required min="1" 
                   oninput="checkAndToggleFilled('meterConstant'); clearErrorHighlight(); calculate()" 
                   placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥, 6400"> 
        </div>
    </div>
    
    <div class="input-group" id="voltageRow"> 
        <div id="voltageGroup" class="styled-input-group">
            <label for="voltage">–ù–∞–ø—Ä—É–≥–∞ (U), –í</label>
            <input type="number" id="voltage" value="" required min="1" 
                   oninput="handleInputExclusion('voltage'); checkAndToggleFilled('voltage'); clearErrorHighlight(); calculate();" 
                   placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥ 230">
        </div>
    </div>
    
    <div class="symbol-separator">X</div> 
    
    <div class="input-group" id="currentRow"> 
        <div id="currentGroup" class="styled-input-group">
            <label for="current">–°—Ç—Ä—É–º (I), –ê</label>
            <input type="number" id="current" value="" required min="0.1" 
                   oninput="handleInputExclusion('current'); checkAndToggleFilled('current'); clearErrorHighlight(); calculate();" 
                   placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥ 16">
        </div>
    </div>
    
    <div class="symbol-separator">= (–ê–ë–û)</div> 
    
    <div class="input-group" id="powerRow">
        <div id="powerGroup" class="styled-input-group">
            <label for="powerMeasured">–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å (P), –∫–í—Ç</label>
            <input type="number" id="powerMeasured" value="" min="0.01" 
                   oninput="handleInputExclusion('power'); checkAndToggleFilled('powerMeasured'); clearErrorHighlight(); calculate();">
        </div>
    </div>
    
    <hr>

    <h2>2. –†–µ–∂–∏–º —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É</h2>

    <div class="mode-button-group">
        <input type="radio" id="modePulses" name="calculationMode" value="pulses" checked onchange="toggleCalcInputs(); calculate();">
        <label for="modePulses">‚è±Ô∏è –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ **–Ü–ú–ü–£–õ–¨–°–ò** (N)</label>

        <input type="radio" id="modeTime" name="calculationMode" value="time" onchange="toggleCalcInputs(); calculate();">
        <label for="modeTime">üìä –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ **–ß–ê–°** (t)</label>
    </div>
    
    <div id="inputTime" class="hidden-input" style="display: block;">
        <div id="timerSection">
            <div id="timerDisplay">00:00.00</div> 
            <div class="timer-buttons">
                <button id="startStopBtn" onclick="toggleTimer()">–°–¢–ê–†–¢</button>
                <button id="resetBtn" onclick="resetTimer()">–°–ö–ò–î–ê–ù–ù–Ø</button>
            </div>
        </div>
    </div>
    
    <div id="inputPulses" class="hidden-input">
        <label for="pulses">–ö—ñ–ª—å–∫—ñ—Å—Ç—å —ñ–º–ø—É–ª—å—Å—ñ–≤ (N):</label>
        <input type="number" id="pulses" value="" required min="1" oninput="clearErrorHighlight(); calculate()" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥, 20">
    </div>


    <hr>

    <h3 id="resultHeader">3. –†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
    <div id="result">
        –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É.
    </div>
    
    <hr>

    <h3 id="referenceHeader" onclick="toggleReference()">4. –î–æ–≤—ñ–¥–∫–∞ (–î–µ—Ç–∞–ª—ñ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É) ‚ñº</h3>
    <div id="referenceContent">
        –¢—É—Ç –±—É–¥–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ —Ñ–æ—Ä–º—É–ª–∏ —Ç–∞ –ø—Ä–æ–º—ñ–∂–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è.
    </div>

</div> 
<div class="footer-link">
    <span style="color: #555; font-size: 0.9em;">–ê–≤—Ç–æ—Ä: Mykhailo Kryzhanivskyi</span>
    <span style="color: #555; font-size: 0.9em;">
        –ó–≤–æ—Ä–æ—Ç–Ω–∏–π –∑–≤'—è–∑–æ–∫: <a href="https://t.me/IcyMike" target="_blank">@IcyMike (Telegram)</a>
        <a href="https://send.monobank.ua/jar/725KySkFSn" target="_blank" class="support-button">
            üí∞ –ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ –ø—Ä–æ–µ–∫—Ç
        </a>
    </span>
    </div>
<script>
    // --- ADDED: playSystemBeep() to generate sound without external files ---
    function playSystemBeep() {
        try {
            // –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Web Audio API –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –±—ñ–ø–∞
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            if (!AudioContext) return; 

            const audioCtx = new AudioContext();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            // –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –±—ñ–ø–∞
            oscillator.type = 'sine'; // –ß–∏—Å—Ç–∞ —Å–∏–Ω—É—Å–æ—ó–¥–∞–ª—å–Ω–∞ —Ö–≤–∏–ª—è
            oscillator.frequency.setValueAtTime(800, audioCtx.currentTime); // –ß–∞—Å—Ç–æ—Ç–∞ 800 Hz
            gainNode.gain.setValueAtTime(1, audioCtx.currentTime); // –ü–æ—á–∞—Ç–∫–æ–≤–∞ –≥—É—á–Ω—ñ—Å—Ç—å

            // –®–≤–∏–¥–∫–µ –∑–≥–∞—Å–∞–Ω–Ω—è –≥—É—á–Ω–æ—Å—Ç—ñ
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.1);

            // –°—Ç–∞—Ä—Ç —ñ —à–≤–∏–¥–∫–∏–π —Å—Ç–æ–ø (100 –º—Å)
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.1); 
            
        } catch (e) {
            // –Ü–≥–Ω–æ—Ä—É—î–º–æ –ø–æ–º–∏–ª–∫–∏, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ –ø–æ–ª—ñ—Ç–∏–∫–æ—é –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫—É –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö
            console.error("Audio API error:", e);
        }
    }
    // ------------------------------------------------------------------------

    let timerInterval;
    let flashInterval; // –î–æ–¥–∞–Ω–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –±–ª–∏–º–∞–Ω–Ω—è
    let startTime;
    let elapsedTime = 0; // –ß–∞—Å –≤ –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∞—Ö
    
    /**
     * –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è —á–µ—Ä–≤–æ–Ω–æ–≥–æ –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –∑ —É—Å—ñ—Ö –ø–æ–ª—ñ–≤.
     */
    function clearErrorHighlight() {
        document.getElementById('voltageGroup').classList.remove('error-highlight');
        document.getElementById('currentGroup').classList.remove('error-highlight');
        document.getElementById('powerGroup').classList.remove('error-highlight');
        document.getElementById('meterConstantGroup').classList.remove('error-highlight');
        document.getElementById('inputPulses').classList.remove('error-highlight');
    }

    /**
     * –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è/–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Ä–æ–∑–¥—ñ–ª—É –î–æ–≤—ñ–¥–∫–∏
     */
    function toggleReference() {
        const content = document.getElementById('referenceContent');
        const header = document.getElementById('referenceHeader');
        
        if (content.style.display === 'none' || content.style.display === '') {
            content.style.display = 'block';
            header.innerHTML = "4. –î–æ–≤—ñ–¥–∫–∞ (–î–µ—Ç–∞–ª—ñ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É) ‚ñ≤";
        } else {
            content.style.display = 'none';
            header.innerHTML = "4. –î–æ–≤—ñ–¥–∫–∞ (–î–µ—Ç–∞–ª—ñ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É) ‚ñº";
        }
    }


    /**
     * –î–∏–Ω–∞–º—ñ—á–Ω–æ –¥–æ–¥–∞—î/–≤–∏–¥–∞–ª—è—î –∫–ª–∞—Å 'filled' –¥–ª—è –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –ø–æ–ª—è.
     */
    function checkAndToggleFilled(inputId) {
        const inputElement = document.getElementById(inputId);
        let groupId;
        if (inputId === 'voltage') groupId = 'voltageGroup';
        else if (inputId === 'current') groupId = 'currentGroup';
        else if (inputId === 'powerMeasured') groupId = 'powerGroup';
        else if (inputId === 'meterConstant') groupId = 'meterConstantGroup'; 
        
        const groupElement = document.getElementById(groupId);

        if (inputElement.value.trim() !== '') {
            groupElement.classList.add('filled');
        } else {
            groupElement.classList.remove('filled');
        }
    }

    function handleInputExclusion(changedField) {
        const voltageInput = document.getElementById('voltage');
        const currentInput = document.getElementById('current');
        const powerInput = document.getElementById('powerMeasured');
        
        const updateFilledClasses = () => {
             checkAndToggleFilled('voltage');
             checkAndToggleFilled('current');
             checkAndToggleFilled('powerMeasured');
             checkAndToggleFilled('meterConstant'); 
        };

        if (changedField === 'power') {
            if (powerInput.value !== '') {
                voltageInput.value = '';
                currentInput.value = '';
            }
        } else if (changedField === 'voltage' || changedField === 'current') {
            if (voltageInput.value !== '' || currentInput.value !== '') {
                powerInput.value = '';
            }
        }
        
        updateFilledClasses();
    }

    /**
     * –û–ù–û–í–õ–ï–ù–û: –§–æ—Ä–º–∞—Ç—É—î —á–∞—Å —É –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∞—Ö –¥–æ MM:SS.ms
     */
    function formatTime(ms) {
        let totalSeconds = Math.floor(ms / 1000);
        // let hours = Math.floor(totalSeconds / 3600); // –í–ò–î–ê–õ–ï–ù–û
        let minutes = Math.floor(totalSeconds / 60); // –ó–º—ñ–Ω–µ–Ω–æ –Ω–∞ –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ö–≤–∏–ª–∏–Ω
        let seconds = totalSeconds % 60;
        let milliseconds = Math.floor((ms % 1000) / 10); 

        return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}.${String(milliseconds).padStart(2, '0')}`;
        // –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫–æ–¥: return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}.${String(milliseconds).padStart(2, '0')}`;
    }
    
    function formatHoursMinutesSeconds(t_hours) {
        let hours = Math.floor(t_hours);
        let totalMinutes = (t_hours - hours) * 60;
        let minutes = Math.floor(totalMinutes);
        let seconds = Math.round((totalMinutes - minutes) * 60);
        
        return `${hours} –≥–æ–¥ ${minutes} —Ö–≤ ${seconds} —Å–µ–∫`;
    }

    function toggleCalcInputs() {
        const mode = document.querySelector('input[name="calculationMode"]:checked').value;
        
        const inputTimeDiv = document.getElementById('inputTime');
        const inputPulsesDiv = document.getElementById('inputPulses');
        
        if (mode === 'pulses') {
            inputTimeDiv.style.display = 'block';
            inputPulsesDiv.style.display = 'none';
        } else { // mode === 'time'
            inputTimeDiv.style.display = 'none';
            inputPulsesDiv.style.display = 'block';
        }
        
        if (timerInterval) {
            stopTimer(false); 
        }
        // –ó—É–ø–∏–Ω—è—î–º–æ –±–ª–∏–º–∞–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ä–µ–∂–∏–º—É
        stopFlashing(); 
        
        elapsedTime = 0;
        // –û–ù–û–í–õ–ï–ù–û: –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ñ–æ—Ä–º–∞—Ç—É –¥–∏—Å–ø–ª–µ—è
        document.getElementById('timerDisplay').textContent = "00:00.00"; 
        document.getElementById('startStopBtn').textContent = "–°–¢–ê–†–¢";
        document.getElementById('startStopBtn').style.backgroundColor = "#17a2b8";
        
        clearErrorHighlight(); // –û—á–∏—â–µ–Ω–Ω—è –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ä–µ–∂–∏–º—É
        calculate();
    }
    
    // --- –§–£–ù–ö–¶–Ü–á –ë–õ–ò–ú–ê–ù–ù–Ø (–°–ò–ù–•–†–û–ù–Ü–ó–ê–¶–Ü–Ø –ó –õ–Ü–ß–ò–õ–¨–ù–ò–ö–û–ú) ---

    /**
     * –Ü–Ω—ñ—Ü—ñ—é—î –±–ª–∏–º–∞–Ω–Ω—è —Ñ–æ–Ω—É –∑ —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–æ—é —á–∞—Å—Ç–æ—Ç–æ—é.
     * @param {number} P_kW_calculated - –†–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å —É –∫–í—Ç.
     * @param {number} C - –ü–æ—Å—Ç—ñ–π–Ω–∞ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞.
     */
    function startFlashing(P_kW_calculated, C) {
        stopFlashing(); // –ó—É–ø–∏–Ω—è—î–º–æ, —è–∫—â–æ –≤–∂–µ –ø—Ä–∞—Ü—é—î

        // –§–æ—Ä–º—É–ª–∞ –¥–ª—è —á–∞—Å—É –º—ñ–∂ —ñ–º–ø—É–ª—å—Å–∞–º–∏ (–ø–µ—Ä—ñ–æ–¥—É) –≤ –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∞—Ö:
        // T_imp = (1 –∫–í—Ç¬∑–≥–æ–¥ / P –∫–í—Ç) * (3600 —Å–µ–∫/–≥–æ–¥ * 1000 –º—Å/—Å–µ–∫) / C —ñ–º–ø/–∫–í—Ç¬∑–≥–æ–¥
        // T_imp (–º—Å) = (3600 * 1000) / (C * P)
        const flashPeriodMs = (3600 * 1000) / (C * P_kW_calculated);
        
        // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞ –ø–æ–≤–Ω–∏–π –ø–µ—Ä—ñ–æ–¥
        const timerSection = document.getElementById('timerSection');

        flashInterval = setInterval(() => {

            // üîä Play system beep
            playSystemBeep();

            // –Ü–º—ñ—Ç—É—î–º–æ –¥—É–∂–µ –∫–æ—Ä–æ—Ç–∫–∏–π —ñ–º–ø—É–ª—å—Å (–±–ª–∏–º–∞–Ω–Ω—è —Ç—Ä–∏–≤–∞—î 100 –º—Å)
            timerSection.classList.add('flash-active');
            setTimeout(() => {
                timerSection.classList.remove('flash-active');
            }, 100); 

        }, flashPeriodMs); 
    }

    /**
     * –ó—É–ø–∏–Ω—è—î –±–ª–∏–º–∞–Ω–Ω—è.
     */
    function stopFlashing() {
        if (flashInterval) {
            clearInterval(flashInterval);
            flashInterval = null;
        }
        // –ó–∞–±–µ–∑–ø–µ—á—É—î–º–æ, —â–æ —Ñ–æ–Ω –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ
        document.getElementById('timerSection').classList.remove('flash-active');
    }

    // --- –§–£–ù–ö–¶–Ü–á –°–ï–ö–£–ù–î–û–ú–Ü–†–ê ---

    function updateTimerDisplay() {
        const now = Date.now();
        elapsedTime = now - startTime;
        document.getElementById('timerDisplay').textContent = formatTime(elapsedTime);
    }

    function startTimer() {
        if (timerInterval) return; 
        
        clearErrorHighlight(); // –ü—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ —Ç–∞–π–º–µ—Ä–∞ –ø—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ –≤—Å–µ –≥–∞—Ä–∞–∑–¥
        
        const U = parseFloat(document.getElementById('voltage').value); 
        const I = parseFloat(document.getElementById('current').value); 
        const C = parseFloat(document.getElementById('meterConstant').value); 
        const P_measured = parseFloat(document.getElementById('powerMeasured').value);
        const P_kW_calculated = calculatePower(U, I, P_measured);
        
        const resultDiv = document.getElementById('result');
        const referenceDiv = document.getElementById('referenceContent'); 
        
        // –í–∞–ª—ñ–¥–∞—Ü—ñ—è –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º
        if (isNaN(C) || C <= 0 || P_kW_calculated === null || P_kW_calculated <= 0) {
             // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –ø–æ–ª—è U, I, P, C
             document.getElementById('voltageGroup').classList.add('error-highlight');
             document.getElementById('currentGroup').classList.add('error-highlight');
             document.getElementById('powerGroup').classList.add('error-highlight');
             document.getElementById('meterConstantGroup').classList.add('error-highlight');
             resultDiv.innerHTML = "‚ùå **–ü–æ–º–∏–ª–∫–∞:** –í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—ñ **–¢–µ—Ö–Ω—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ (U, I, P —Ç–∞ C)** –ø–µ—Ä–µ–¥ –ø–æ—á–∞—Ç–∫–æ–º –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è.";
             referenceDiv.innerHTML = "–í–≤–µ–¥—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É.";
             return;
        }


        resultDiv.innerHTML = "‚è±Ô∏è **–°–µ–∫—É–Ω–¥–æ–º—ñ—Ä –ø—Ä–∞—Ü—é—î...** –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **–°–¢–û–ü** –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É.";
        
        // –ó–∞–ø—É—Å–∫ –±–ª–∏–º–∞–Ω–Ω—è
        startFlashing(P_kW_calculated, C); 

        startTime = Date.now() - elapsedTime;
        timerInterval = setInterval(updateTimerDisplay, 10); 
        
        document.getElementById('startStopBtn').textContent = "–°–¢–û–ü";
        // –ó–ú–Ü–ù–ê: –ó–º—ñ–Ω–µ–Ω–æ –∫–æ–ª—ñ—Ä –∫–Ω–æ–ø–∫–∏ –°–¢–û–ü –Ω–∞ –ø–æ–º–∞—Ä–∞–Ω—á–µ–≤–∏–π
        document.getElementById('startStopBtn').style.backgroundColor = "#ff6a00"; 
        
        // –û–Ω–æ–≤–ª–µ–Ω–æ: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ referenceContent
        document.getElementById('referenceContent').innerHTML = "–û—á—ñ–∫—É–≤–∞–Ω–Ω—è –Ω–∞ –∑—É–ø–∏–Ω–∫—É —Å–µ–∫—É–Ω–¥–æ–º—ñ—Ä–∞ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É...";
    }

    function stopTimer(doCalculation = true) {
        if (!timerInterval) return;
        clearInterval(timerInterval);
        timerInterval = null;

        // –ó—É–ø–∏–Ω–∫–∞ –±–ª–∏–º–∞–Ω–Ω—è
        stopFlashing(); 

        document.getElementById('startStopBtn').textContent = "–°–¢–ê–†–¢";
        document.getElementById('startStopBtn').style.backgroundColor = "#17a2b8";
        
        if (doCalculation) {
            calculateFromTimer(elapsedTime);
            // –ê–í–¢–û–ú–ê–¢–ò–ß–ù–ò–ô –°–ö–†–û–õ –î–û –†–ï–ó–£–õ–¨–¢–ê–¢–£
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        }
    }

    function toggleTimer() {
        if (timerInterval) {
            stopTimer(true);
        } else {
            startTimer();
        }
    }

    function resetTimer() {
        stopTimer(false); 
        elapsedTime = 0;
        // –û–ù–û–í–õ–ï–ù–û: –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ñ–æ—Ä–º–∞—Ç—É –¥–∏—Å–ø–ª–µ—è
        document.getElementById('timerDisplay').textContent = "00:00.00"; 
        calculate();
    }

    /**
     * –†–æ–∑—Ä–∞—Ö–æ–≤—É—î –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å.
     */
    function calculatePower(U, I, P_measured) {
        if (!isNaN(P_measured) && P_measured > 0) {
            return P_measured;
        }
        
        if (isNaN(U) || isNaN(I) || U <= 0 || I <= 0) {
            return null; 
        }
        
        const phaseFactor = 1; 
        const CT = 1; 
        
        return (phaseFactor * U * I * CT) / 1000;
    }

    /**
     * –ì–µ–Ω–µ—Ä—É—î HTML-–∫–æ–¥ –¥–ª—è –¥–æ–≤—ñ–¥–∫–∏.
     */
    function generateReferenceHTML(calcMode, U, I, P_measured, C, N_input, timeMs, P_kW_calculated, N_pulses, t_hours) {
        let html = '';
        let formulaPower = '';
        let valuesPower = [];
        
        const multiplicationDot = '\u00B7'; 

        // 1. –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ü–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ (P)
        html += '<h4>1. –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ü–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ (P)</h4>';
        if (!isNaN(P_measured) && P_measured > 0) {
            formulaPower = `P = P\u208B\u043C\u0456\u0440\u044F\u043D\u0430`;
            valuesPower.push(`P\u208B\u043C\u0456\u0440\u044F\u043D\u0430 (–≤–≤–µ–¥–µ–Ω–∞): <strong>${P_measured}</strong> –∫–í—Ç`);
            valuesPower.push(`P (–†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å): <strong>${P_kW_calculated.toFixed(3)}</strong> –∫–í—Ç`);
        } else if (!isNaN(U) && !isNaN(I) && P_kW_calculated !== null) {
            // –û–ù–û–í–õ–ï–ù–û: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å–∏–º–≤–æ–ª X –¥–ª—è –º–Ω–æ–∂–µ–Ω–Ω—è —É —Ñ–æ—Ä–º—É–ª—ñ
            formulaPower = `P = (U X I) / 1000 (–∑–∞ —É–º–æ–≤–∏ cos(\u03C6) \u2248 1)`;
            valuesPower.push(`U (–ù–∞–ø—Ä—É–≥–∞): <strong>${U}</strong> –í`);
            valuesPower.push(`I (–°—Ç—Ä—É–º): <strong>${I}</strong> –ê`);
            valuesPower.push(`P = (${U} X ${I}) / 1000 = <strong>${P_kW_calculated.toFixed(3)}</strong> –∫–í—Ç`);
        } else {
             return "–î–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ–≤—ñ–¥–∫–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤–≤–µ—Å—Ç–∏ –∫–æ—Ä–µ–∫—Ç–Ω—ñ —Ç–µ—Ö–Ω—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ (U —Ç–∞ I, –∞–±–æ P).";
        }
        
        html += `<code class="formula">${formulaPower}</code>
                 <ul class="value-list">
                    ${valuesPower.map(v => `<li>${v}</li>`).join('')}
                    <li>–ü–æ—Å—Ç—ñ–π–Ω–∞ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ (C): <strong>${C}</strong> —ñ–º–ø/–∫–í—Ç\u00B7–≥–æ–¥</li>
                 </ul>`;

        // 2. –û—Å–Ω–æ–≤–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫
        if (calcMode === 'pulses' && timeMs !== null && timeMs > 0) {
            const t_seconds = timeMs / 1000;
            const t_seconds_fixed = t_seconds.toFixed(2);
            
            html += `<h4>2. –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –Ü–º–ø—É–ª—å—Å—ñ–≤ (N)</h4>
                     <p>–§–æ—Ä–º—É–ª–∞ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —ñ–º–ø—É–ª—å—Å—ñ–≤, –±–∞–∑—É—é—á–∏—Å—å –Ω–∞ –ø–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ —Ç–∞ —á–∞—Å—ñ (—É —Å–µ–∫—É–Ω–¥–∞—Ö):</p>`;

            html += `<code class="formula">N = (P ${multiplicationDot} t\u208B\u0441\u0435\u043A ${multiplicationDot} C) / 3600</code>
                     <ul class="value-list">
                        <li>–ó–∞–º—ñ—Ä—è–Ω–∏–π –ß–∞—Å (t\u208B\u0441\u0435\u043A): <strong>${t_seconds_fixed}</strong> —Å–µ–∫</li>
                        <li>N = (${P_kW_calculated.toFixed(3)} ${multiplicationDot} ${t_seconds_fixed} ${multiplicationDot} ${C}) / 3600 = <strong>${N_pulses.toFixed(2)}</strong> —ñ–º–ø</li>
                     </ul>`;
                     
            // –î–æ–¥–∞—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —á–∞—Å—Ç–æ—Ç—É –±–ª–∏–º–∞–Ω–Ω—è
            const flashPeriodMs = (3600 * 1000) / (C * P_kW_calculated);
            html += `<p>–ü—Ä–æ–º—ñ–∂–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫:</p>
                     <ul class="value-list">
                        <li>–†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–∏–π –ø–µ—Ä—ñ–æ–¥ –º—ñ–∂ —ñ–º–ø—É–ª—å—Å–∞–º–∏ (T\u208B\u043C\u043F): <strong>${flashPeriodMs.toFixed(0)}</strong> –º—Å</li>
                     </ul>`;


        } else if (calcMode === 'time' && N_input > 0) {
            const E_kWh = N_input / C; 
            const t_hours = E_kWh / P_kW_calculated;
            const t_seconds = t_hours * 3600; 
            const t_seconds_fixed = t_seconds.toFixed(2);
            
            html += `<h4>2. –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ß–∞—Å—É (t)</h4>
                     <p>–§–æ—Ä–º—É–ª–∞ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –æ—á—ñ–∫—É–≤–∞–Ω–æ–≥–æ —á–∞—Å—É (—É —Å–µ–∫—É–Ω–¥–∞—Ö), –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ–≥–æ –¥–ª—è N —ñ–º–ø—É–ª—å—Å—ñ–≤:</p>`;

            html += `<code class="formula">t\u208B\u0441\u0435\u043A = (N ${multiplicationDot} 3600) / (C ${multiplicationDot} P)</code>
                     <ul class="value-list">
                        <li>–í–≤–µ–¥–µ–Ω—ñ –Ü–º–ø—É–ª—å—Å–∏ (N): <strong>${N_input}</strong> —ñ–º–ø</li>
                        <li>t\u208B\u0441\u0435\u043A = (${N_input} ${multiplicationDot} 3600) / (${C} ${multiplicationDot} ${P_kW_calculated.toFixed(3)})</li>
                        <li>t\u208B\u0441\u0435\u043A (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö): <strong>${t_seconds_fixed}</strong> —Å–µ–∫</li>
                        <li>t (—É —Ñ–æ—Ä–º–∞—Ç—ñ –ì:–•:–°): <strong>${formatHoursMinutesSeconds(t_hours)}</strong></li>
                     </ul>`;
        } else {
             return "–î–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ–≤—ñ–¥–∫–∏ –≤–∏–∫–æ–Ω–∞–π—Ç–µ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫, –≤–≤—ñ–≤—à–∏ –≤—Å—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ.";
        }
        
        return html;
    }


    function calculateFromTimer(timeMs) {
        if (document.querySelector('input[name="calculationMode"]:checked').value !== 'pulses') {
            return;
        }
        
        clearErrorHighlight(); // –ü–æ—á–∞—Ç–æ–∫ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó

        const U = parseFloat(document.getElementById('voltage').value); 
        const I = parseFloat(document.getElementById('current').value); 
        const C = parseFloat(document.getElementById('meterConstant').value); 
        const P_measured = parseFloat(document.getElementById('powerMeasured').value);
        const resultDiv = document.getElementById('result');
        const referenceDiv = document.getElementById('referenceContent'); 

        // 1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ü–æ—Å—Ç—ñ–π–Ω–æ—ó –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞
        if (isNaN(C) || C <= 0) {
             document.getElementById('meterConstantGroup').classList.add('error-highlight');
             resultDiv.innerHTML = "‚ùå **–ü–æ–º–∏–ª–∫–∞:** –í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—É **–ü–æ—Å—Ç—ñ–π–Ω—É** –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ (C).";
             referenceDiv.innerHTML = "–í–≤–µ–¥—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É.";
             return;
        }
        
        const P_kW_calculated = calculatePower(U, I, P_measured);

        // 2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ü–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ
        if (P_kW_calculated === null || P_kW_calculated <= 0) {
            // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –≤—Å—ñ –ø–æ–ª—è –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –ø–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ
            document.getElementById('voltageGroup').classList.add('error-highlight');
            document.getElementById('currentGroup').classList.add('error-highlight');
            document.getElementById('powerGroup').classList.add('error-highlight');
            
            resultDiv.innerHTML = "‚ùå **–ü–æ–º–∏–ª–∫–∞:** –í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è **–ü–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ (P)** –ê–ë–û –∑–∞–ø–æ–≤–Ω—ñ—Ç—å **–ù–∞–ø—Ä—É–≥—É (U)** —Ç–∞ **–°—Ç—Ä—É–º (I)**.";
            referenceDiv.innerHTML = "–í–≤–µ–¥—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É.";
            return;
        }
        
        // 3. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ß–∞—Å—É
        if (timeMs === 0) {
            // –û–ù–û–í–õ–ï–ù–û: –§–æ—Ä–º–∞—Ç —á–∞—Å—É
            resultDiv.innerHTML = "‚ö†Ô∏è **–ü–æ–º–∏–ª–∫–∞:** –°–µ–∫—É–Ω–¥–æ–º—ñ—Ä –∑—É–ø–∏–Ω–µ–Ω–æ –Ω–∞ 00:00.00. –°–ø–æ—á–∞—Ç–∫—É –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –°–¢–ê–†–¢."; 
            referenceDiv.innerHTML = "–í–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è —á–∞—Å—É –Ω–µ –±—É–ª–æ —Ä–æ–∑–ø–æ—á–∞—Ç–æ.";
            return;
        }

        const t_hours = timeMs / 3600000; 
        const E_kWh = P_kW_calculated * t_hours; 
        const N_pulses = E_kWh * C;
        
        // ==============================================================
        // –û–ù–û–í–õ–ï–ù–û: –í–∏–≤—ñ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —É —Ñ–æ—Ä–º–∞—Ç—ñ "–¢–∞–±–ª–æ"
        // ==============================================================
        const N_pulses_rounded = Math.round(N_pulses);
        const t_seconds_rounded = Math.round(timeMs / 1000); // –ß–∞—Å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

        resultDiv.innerHTML = `
            <p>‚úÖ **–†–û–ó–†–ê–•–£–ù–û–ö –ó–ê –ß–ê–°–û–ú (–†–ï–ñ–ò–ú ‚è±Ô∏è)**</p>
            
            <div class="large-result-display">
                <div class="result-block">
                    <span class="result-value">${N_pulses_rounded}</span>
                    <span class="result-label">–Ü–º–ø—É–ª—å—Å—ñ–≤ (N)</span>
                </div>
                
                <span class="result-separator">/</span>
                
                <div class="result-block">
                    <span class="result-value">${t_seconds_rounded}</span>
                    <span class="result-label">–°–µ–∫—É–Ω–¥ (t)</span>
                </div>
            </div>
            
            <p style="font-size: 1em; color: #333;">(–¢–æ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è N: <strong>${N_pulses.toFixed(2)}</strong> —ñ–º–ø)</p>`;
        // ==============================================================

        referenceDiv.innerHTML = generateReferenceHTML('pulses', U, I, P_measured, C, null, timeMs, P_kW_calculated, N_pulses, t_hours);
    }

    function calculate() {
        const calcMode = document.querySelector('input[name="calculationMode"]:checked').value;
        const resultDiv = document.getElementById('result');
        const referenceDiv = document.getElementById('referenceContent'); 
        
        clearErrorHighlight(); // –ü–æ—á–∞—Ç–æ–∫ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
        stopFlashing(); // –ó—É–ø–∏–Ω—è—î–º–æ –±–ª–∏–º–∞–Ω–Ω—è, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–µ –π–¥–µ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è

        const U = parseFloat(document.getElementById('voltage').value); 
        const I = parseFloat(document.getElementById('current').value); 
        const C = parseFloat(document.getElementById('meterConstant').value); 
        const N = parseFloat(document.getElementById('pulses').value); 
        const P_measured = parseFloat(document.getElementById('powerMeasured').value);
        
        const powerMeasuredInput = document.getElementById('powerMeasured');

        // === –õ–û–ì–Ü–ö–ê –î–ò–ù–ê–ú–Ü–ß–ù–û–ì–û PLACEHOLDER –î–õ–Ø –ü–û–¢–£–ñ–ù–û–°–¢–Ü (P) ===
        let impliedP = null;
        if (!isNaN(U) && !isNaN(I) && U > 0 && I > 0) {
            impliedP = (U * I) / 1000;
        } 
        
        if (powerMeasuredInput.value === '') {
            if (impliedP !== null) {
                powerMeasuredInput.placeholder = `–†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–µ: ${impliedP.toFixed(3)} –∫–í—Ç`;
            } else {
                // –ó–ú–Ü–ù–ê 4: –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ–¥–∫–∞–∑–∫–∏ –¥–æ U*I/1000
                powerMeasuredInput.placeholder = "–ù–∞–ø—Ä–∏–∫–ª–∞–¥ 1.5 (U*I/1000)";
            }
        } 
        // =========================================================

        // 1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ü–æ—Å—Ç—ñ–π–Ω–æ—ó –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞
        if (isNaN(C) || C <= 0) {
            document.getElementById('meterConstantGroup').classList.add('error-highlight');
            resultDiv.innerHTML = "–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—É **–ü–æ—Å—Ç—ñ–π–Ω—É** –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ (C).";
            referenceDiv.innerHTML = "–í–≤–µ–¥—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É.";
            return;
        }
        
        const P_kW_calculated = calculatePower(U, I, P_measured);

        if (calcMode === 'pulses') {
            if (P_kW_calculated !== null && P_kW_calculated > 0) {
                 // –û–ù–û–í–õ–ï–ù–û: –í—ñ–¥–æ–±—Ä–∞–∂–∞—î–º–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–∏–π –ø–µ—Ä—ñ–æ–¥ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
                 const flashPeriodMs = (3600 * 1000) / (C * P_kW_calculated);
                 const flashFreq = 1000 / flashPeriodMs; // —ñ–º–ø/—Å–µ–∫
                 
                 resultDiv.innerHTML = `
                    ‚úÖ **–ì–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å!** <br>
                    **–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å** –≤–∏–∑–Ω–∞—á–µ–Ω–∞: **${P_kW_calculated.toFixed(3)} –∫–í—Ç**. <br>
                    –†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–∞ —á–∞—Å—Ç–æ—Ç–∞ —ñ–º–ø—É–ª—å—Å—ñ–≤: **${flashFreq.toFixed(3)} —ñ–º–ø/—Å** (–∞–±–æ **${flashPeriodMs.toFixed(0)} –º—Å** –º—ñ–∂ —ñ–º–ø—É–ª—å—Å–∞–º–∏). <br>
                    –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **–°–¢–ê–†–¢** –¥–ª—è –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è —á–∞—Å—É.
                 `;
                 
                 referenceDiv.innerHTML = generateReferenceHTML('pulses', U, I, P_measured, C, null, null, P_kW_calculated, null, null);
            } else {
                 // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –ø–æ–ª—è U, I, P
                 document.getElementById('voltageGroup').classList.add('error-highlight');
                 document.getElementById('currentGroup').classList.add('error-highlight');
                 document.getElementById('powerGroup').classList.add('error-highlight');
                 
                 resultDiv.innerHTML = "–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ **U** —Ç–∞ **I**, –∞–±–æ **P** —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **–°–¢–ê–†–¢**.";
                 referenceDiv.innerHTML = "–í–≤–µ–¥—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É.";
            }
            
            return;
        }
        
        if (calcMode === 'time') {
            // 2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ö—ñ–ª—å–∫—ñ—Å—Ç—å —ñ–º–ø—É–ª—å—Å—ñ–≤
            if (isNaN(N) || N <= 0) {
                 document.getElementById('inputPulses').classList.add('error-highlight');
                 resultDiv.innerHTML = "–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—É **–ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ü–º–ø—É–ª—å—Å—ñ–≤ (N)**.";
                 referenceDiv.innerHTML = "–í–≤–µ–¥—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É.";
                 return;
            }

            // 3. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ü–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ
            if (P_kW_calculated === null || P_kW_calculated <= 0) {
                // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –ø–æ–ª—è U, I, P
                document.getElementById('voltageGroup').classList.add('error-highlight');
                document.getElementById('currentGroup').classList.add('error-highlight');
                document.getElementById('powerGroup').classList.add('error-highlight');
                
                resultDiv.innerHTML = "‚ùå **–ü–æ–º–∏–ª–∫–∞:** –í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è **–ü–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ (P)** –ê–ë–û –∑–∞–ø–æ–≤–Ω—ñ—Ç—å **–ù–∞–ø—Ä—É–≥—É (U)** —Ç–∞ **–°—Ç—Ä—É–º (I)**.";
                referenceDiv.innerHTML = "–í–≤–µ–¥—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É.";
                return;
            }

            const E_kWh = N / C; 
            const t_hours = E_kWh / P_kW_calculated;

            const detailedTimeDisplay = formatHoursMinutesSeconds(t_hours);
            
            // ==============================================================
            // –û–ù–û–í–õ–ï–ù–û: –í–∏–≤—ñ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —É —Ñ–æ—Ä–º–∞—Ç—ñ "–¢–∞–±–ª–æ"
            // ==============================================================
            const t_seconds_rounded = Math.round(t_hours * 3600);

            resultDiv.innerHTML = `
                <p>‚úÖ **–†–û–ó–†–ê–•–£–ù–û–ö –ó–ê –Ü–ú–ü–£–õ–¨–°–ê–ú–ò (–†–ï–ñ–ò–ú üìä)**</p>
                
                <div class="large-result-display">
                    <div class="result-block">
                        <span class="result-value">${N}</span>
                        <span class="result-label">–Ü–º–ø—É–ª—å—Å—ñ–≤ (N)</span>
                    </div>
                    
                    <span class="result-separator">/</span>
                    
                    <div class="result-block">
                        <span class="result-value">${t_seconds_rounded}</span>
                        <span class="result-label">–û—á—ñ–∫—É–≤–∞–Ω–∏—Ö –°–µ–∫—É–Ω–¥ (t)</span>
                    </div>
                </div>
                
                <p style="font-size: 1em; color: #333;">(–£ —Ñ–æ—Ä–º–∞—Ç—ñ –ì:–•:–°: <strong>${detailedTimeDisplay}</strong>)</p>`;
            // ==============================================================

            referenceDiv.innerHTML = generateReferenceHTML('time', U, I, P_measured, C, N, null, P_kW_calculated, null, t_hours);
        }
    }

    // --- –Ü–ù–Ü–¶–Ü–ê–õ–Ü–ó–ê–¶–Ü–Ø ---
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('modePulses').checked = true;
        
        checkAndToggleFilled('voltage');
        checkAndToggleFilled('current');
        checkAndToggleFilled('powerMeasured');
        checkAndToggleFilled('meterConstant'); 
        
        calculate(); 
        toggleCalcInputs();
        
        // –ó–≥–æ—Ä—Ç–∞—î–º–æ –¥–æ–≤—ñ–¥–∫—É –ø—ñ—Å–ª—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
        document.getElementById('referenceContent').style.display = 'none';
        document.getElementById('referenceHeader').innerHTML = "4. –î–æ–≤—ñ–¥–∫–∞ (–î–µ—Ç–∞–ª—ñ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É) ‚ñº";
    });
</script>

</body>
</html>
